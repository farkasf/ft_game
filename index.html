<!DOCTYPE html>
<html data-bs-theme="light" lang="en" style="height: 95%;width: 95%;">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>pong</title>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Work+Sans:300,400,500,700,800&amp;display=swap">
    <link rel="stylesheet" href="assets/css/Login-Form-Basic-icons.css">
    <link rel="stylesheet" href="assets/css/styles.css">
	<script data-require="three.js@0.128.0" data-semver="0.128.0" src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
	<script src="pong_game.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Exo+2&display=swap" rel="stylesheet">
</head>

<body>
	<main class="w-100 h-100">
		<section class="d-flex flex-column" style="width: 100%;height: 100%;background: url(&quot;assets/img/background.gif&quot;) center / 100% 101% no-repeat;margin: 0;" id="content">
			<div class="container d-flex justify-content-center justify-content-md-start align-items-md-start" style="padding: 5px;height: auto;">
				<button class="btn btn-sm fs-5" type="button" style="padding: 5px;width: 3%;background: #000000;">en</button>
				<button class="btn btn-sm fs-5" type="button" style="margin: 0 15px;padding: 5px;width: 3%;background: #000000;">cs</button>
				<button class="btn btn-sm fs-5" type="button" style="padding: 5px;width: 3%;background: #000000;">it</button>
			</div>
			<div class="container d-flex justify-content-center align-items-end">
				<button class="btn btn-light fs-3" type="button" style="padding: 20px;width: 15%;" onclick="loadPage('home')">login</button>
				<button class="btn btn-light fs-3" type="button" style="margin: 0 70px;padding: 20px;width: 15%;" onclick="loadPage('sign_up')">sign up</button>
				<button class="btn btn-light fs-3" type="button" style="padding: 20px;width: 15%;">about</button>
			</div>
			<div class="container d-flex flex-column justify-content-end align-items-start">
				<h1 class="display-3 fw-bold text-main">ft_transcendence</h1>
				<p class="text-info text-badge mb-5">created by sbenes, gabtan, ffarkas, tkajanek &amp; ehasalu</p>
			</div>
		</section>
	</main>
    
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script>
		let currentPage
		
		document.addEventListener("keydown",(e)=>{
        	console.log(e.keyCode)
			if (e.keyCode !== 81) return
			if (currentPage === "game") {
				loadPage("home")
			} else if (currentPage === "tournament") {
				loadPage("home")
			}
    	})

		function manageMode() {
			console.log("entered gamemode option")
			if (gameMode === 3)
				loadPage('tournament')
			else
				loadPage('game')
		}

        function loadPage(pageName) {
			fetch(pageName + ".html")
			.then((response)=>response.text())
			.then((html)=>{
				document.querySelector("main").innerHTML = html;
				history.pushState({ page: pageName }, '', pageName);

				currentPage = pageName

				if (pageName === "home") addChoiceListeners()

				if (pageName === "tournament") changeTableListener()

				if (pageName === "game") {
					if (gameMode === 1) {
						document.querySelector("#player2name").innerHTML = "AI";
						document.querySelector("#controls").innerHTML = "Player 1: arrows";
					}
				}
			})
			.catch((err)=>console.log("Failed to fetch page:", err))
        }

        window.addEventListener('popstate', function(event) {
            if (event.state && event.state.page) {
                loadPage(event.state.page);
            } else {
                loadPage('index');
            }
        });

		function updateImage(imageSrc, text) {
				document.getElementById('image-container').innerHTML = `<img style="max-width: 100%;max-height: 100%;width: 50%;" src="assets/img/${imageSrc}"><p class="fs-4" style="margin-top: 5%;">${text}</p>`;
			}

		function addChoiceListeners() {
				console.log("page home")
				let vsAIChoice = document.getElementById("vsAIChoice");
				let vsPlayerChoice = document.getElementById("vsPlayerChoice");
				let tournamentChoice = document.getElementById("tournamentChoice");
		
			vsAIChoice.addEventListener("change", function() {
				console.log('vsAI checked')
				if (vsAIChoice.checked) {
					gameMode = 1;
				}
			});
		
			vsPlayerChoice.addEventListener("change", function() {
				console.log('vsPlayer checked')
				if (vsPlayerChoice.checked) {
					gameMode = 2;
				}
			});

			tournamentChoice.addEventListener("change", function() {
				console.log('tournament checked')
				if (tournamentChoice.checked) {
					gameMode = 3;
				}
			});
		
			if (vsAIChoice.checked) {
				gameMode = 1;
			} else if (vsPlayerChoice.checked) {
				gameMode = 2;
			} else if (tournamentChoice.checked) {
				gamemode = 3;
			}
		}
		
		function changeTableListener() {
			console.log("listening to table choices")
			let fourP = document.getElementById("fourP");
			let eightP = document.getElementById("eightP");

			fourP.addEventListener("change", function() {
				console.log("four players chosen");
				document.querySelector("#P8Table").innerHTML = "";
			});

			eightP.addEventListener("change", function() {
				console.log("eight players chosen");
				document.querySelector("#P8Table").innerHTML = '<div id="P8Table" class="d-flex d-lg-flex flex-column justify-content-between align-items-center justify-content-lg-center align-items-lg-center" style="height: 50%;width: 50%;"><input class="form-control-lg" type="text" style="color: var(--bs-info);background: rgb(0,0,0);border-style: none;border-top-style: solid;border-top-color: var(--bs-info);border-right-style: solid;border-right-color: var(--bs-info);border-bottom-style: ridge;border-bottom-color: var(--bs-info);border-left-style: solid;border-left-color: var(--bs-info);margin: 1%;" placeholder="alias 5"><input class="form-control-lg" type="text" style="color: var(--bs-info);background: rgb(0,0,0);border-style: none;border-top-style: solid;border-top-color: var(--bs-info);border-right-style: solid;border-right-color: var(--bs-info);border-bottom-style: ridge;border-bottom-color: var(--bs-info);border-left-style: solid;border-left-color: var(--bs-info);margin: 1%;" placeholder="alias 6"><input class="form-control-lg" type="text" style="color: var(--bs-info);background: rgb(0,0,0);border-style: none;border-top-style: solid;border-top-color: var(--bs-info);border-right-style: solid;border-right-color: var(--bs-info);border-bottom-style: ridge;border-bottom-color: var(--bs-info);border-left-style: solid;border-left-color: var(--bs-info);margin: 1%;" placeholder="alias 7"><input class="form-control-lg" type="text" style="color: var(--bs-info);background: rgb(0,0,0);border-style: none;border-top-style: solid;border-top-color: var(--bs-info);border-right-style: solid;border-right-color: var(--bs-info);border-bottom-style: ridge;border-bottom-color: var(--bs-info);border-left-style: solid;border-left-color: var(--bs-info);margin: 1%;" placeholder="alias 8"></div>'
			});

			if (fourP.checked) {
				console.log("four players chosen");
				document.querySelector("#P8Table").innerHTML = "";
			} else if (eightP.checked) {
				console.log("four players chosen");
				document.querySelector("#P8Table").innerHTML = '<div id="P8Table" class="d-flex d-lg-flex flex-column justify-content-between align-items-center justify-content-lg-center align-items-lg-center" style="height: 50%;width: 50%;"><input class="form-control-lg" type="text" style="color: var(--bs-info);background: rgb(0,0,0);border-style: none;border-top-style: solid;border-top-color: var(--bs-info);border-right-style: solid;border-right-color: var(--bs-info);border-bottom-style: ridge;border-bottom-color: var(--bs-info);border-left-style: solid;border-left-color: var(--bs-info);margin: 1%;" placeholder="alias 5"><input class="form-control-lg" type="text" style="color: var(--bs-info);background: rgb(0,0,0);border-style: none;border-top-style: solid;border-top-color: var(--bs-info);border-right-style: solid;border-right-color: var(--bs-info);border-bottom-style: ridge;border-bottom-color: var(--bs-info);border-left-style: solid;border-left-color: var(--bs-info);margin: 1%;" placeholder="alias 6"><input class="form-control-lg" type="text" style="color: var(--bs-info);background: rgb(0,0,0);border-style: none;border-top-style: solid;border-top-color: var(--bs-info);border-right-style: solid;border-right-color: var(--bs-info);border-bottom-style: ridge;border-bottom-color: var(--bs-info);border-left-style: solid;border-left-color: var(--bs-info);margin: 1%;" placeholder="alias 7"><input class="form-control-lg" type="text" style="color: var(--bs-info);background: rgb(0,0,0);border-style: none;border-top-style: solid;border-top-color: var(--bs-info);border-right-style: solid;border-right-color: var(--bs-info);border-bottom-style: ridge;border-bottom-color: var(--bs-info);border-left-style: solid;border-left-color: var(--bs-info);margin: 1%;" placeholder="alias 8"></div>'
			}
		}

    </script>
</body>

</html>
